<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Teacher Dashboard</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body class="container py-5">
    <h2>üë©‚Äçüè´ Teacher Dashboard</h2>

    <!-- Add Quiz Form -->
    <h4 class="mt-4">Add New Quiz</h4>
    <form th:action="@{/api/teachers/add/quiz}" method="post" class="mb-4">
        <div class="mb-3">
            <label for="title" class="form-label">Quiz Title</label>
            <input type="text" class="form-control" id="title" name="title" required>
        </div>
        <div class="mb-3">
            <label for="description" class="form-label">Quiz Description</label>
            <textarea class="form-control" id="description" name="description" required></textarea>
        </div>
        <button type="submit" class="btn btn-success">Add Quiz</button>
    </form>

    <!-- List of Existing Quizzes -->
    <h4>üìÑ Your Quizzes</h4>
    <div th:if="${quizzes != null}">
        <table class="table table-bordered table-hover">
            <thead class="table-light">
                <tr>
                    <th>ID</th>
                    <th>Title</th>
                    <th>Description</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="quiz : ${quizzes}">
                    <td th:text="${quiz.id}"></td>
                    <td th:text="${quiz.title}"></td>
                    <td th:text="${quiz.description}"></td>
                    <td>
                        <!-- Edit Button opens form below -->
                        <button class="btn btn-warning btn-sm" 
                                onclick="fillEditForm([[${quiz.id}]], '[[${quiz.title}]]', '[[${quiz.description}]]')">
                            Edit
                        </button>
                        <a th:href="@{'/api/teachers/delete/' + ${quiz.id}}" class="btn btn-danger btn-sm"
                           onclick="return confirm('Are you sure you want to delete this quiz?');">Delete</a>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Edit Quiz Form -->
    <div class="mt-5">
        <h4>Edit Quiz</h4>
        <form id="editForm" th:action="@{/api/teachers/edit/__id__}" method="post">
            <input type="hidden" id="editId" name="id">
            <div class="mb-3">
                <label for="editTitle" class="form-label">Title</label>
                <input type="text" class="form-control" id="editTitle" name="title" required>
            </div>
            <div class="mb-3">
                <label for="editDescription" class="form-label">Description</label>
                <textarea class="form-control" id="editDescription" name="description" required></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Update Quiz</button>
        </form>
    </div>

    <br><a href="/dashboard" class="btn btn-outline-dark mt-4">‚Üê Back to Dashboard</a>

    <script>
        function fillEditForm(id, title, description) {
            document.getElementById('editId').value = id;
            document.getElementById('editTitle').value = title;
            document.getElementById('editDescription').value = description;

            // Update form action dynamically
            document.getElementById('editForm').action = '/api/teachers/edit/' + id;
            window.scrollTo({ top: document.getElementById('editForm').offsetTop, behavior: 'smooth' });
        }
    </script>
</body>
</html>
